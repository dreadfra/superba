!function(a){window.THB_MediaSelector=function(b){var c=this;c.options=a.extend({},{title:"Media",multiple:!1,type:"",button:"Select",close:function(){},select:function(){}},b),c.frame=null,c.open=function(a){c.frame=wp.media({title:c.options.title,button:{text:c.options.button},library:{type:c.options.type},multiple:c.options.multiple}),c.frame.on("open",function(){var b=c.frame.state().get("selection");b.reset(),_.each(a,function(a){var c=wp.media.attachment(a);c.fetch(),b.add(c?[c]:[])})}),c.frame.on("select",function(){var a=c.frame.state().get("selection"),b=c.options.multiple?a.toJSON():a.first().toJSON();c.options.select(b),delete c}),c.frame.on("close",function(){c.options.close(),delete c}),c.frame.open()}}}(jQuery),function(a){a(document).on("click",".thb-image-upload button",function(){var b=a(this),c=b.parents(".thb-image-upload").first(),d=a("img",c),e=a("input",c);if(e.length){var f=new THB_MediaSelector({select:function(a){d.attr("src",a.sizes.thumbnail.url),e.val(a.id)}});f.open()}return!1}),a(document).on("click",".thb-document-upload button",function(){var b=a(this),c=b.parents(".thb-document-upload").first(),d=a("input",c);if(d.length){var e=new THB_MediaSelector({type:"",select:function(a){d.val(a.url)}});e.open()}return!1})}(jQuery);